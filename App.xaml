<Application x:Class="ContactsManager.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:conv="clr-namespace:ContactsManager.Converters"
             StartupUri="MainWindow.xaml">
        <Application.Resources>
                <!-- Palette - Following spec from copilot.md with grey background and white cards -->
                <Color x:Key="PrimaryColor">#0C8900</Color>
                <Color x:Key="PrimaryDark">#0C8900</Color>
                <Color x:Key="AccentGreen">#39FF13</Color>
                <Color x:Key="AccentBright">#9CFF00</Color>
                <Color x:Key="SurfaceBg">#d9d9d9</Color>
                <Color x:Key="CardBg">#FFFFFF</Color>
                <Color x:Key="TextMain">#333333</Color>
                <Color x:Key="TextSubtle">#666666</Color>
                <Color x:Key="BorderCol">#CCCCCC</Color>

                <SolidColorBrush x:Key="PrimaryBrush"
                                 Color="{StaticResource PrimaryColor}"/>
                <SolidColorBrush x:Key="PrimaryDarkBrush"
                                 Color="{StaticResource PrimaryDark}"/>
                <SolidColorBrush x:Key="SurfaceBrush"
                                 Color="{StaticResource SurfaceBg}"/>
                <SolidColorBrush x:Key="CardBrush"
                                 Color="{StaticResource CardBg}"/>
                <SolidColorBrush x:Key="TextBrush"
                                 Color="{StaticResource TextMain}"/>
                <SolidColorBrush x:Key="SubtleTextBrush"
                                 Color="{StaticResource TextSubtle}"/>
                <SolidColorBrush x:Key="BorderBrushSoft"
                                 Color="{StaticResource BorderCol}"/>

                <conv:InitialsConverter x:Key="InitialsConverter"/>
                <conv:BoolToColorConverter x:Key="BoolToColorConverter"/>
                <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
                <conv:BoolToIntConverter x:Key="BoolToIntConverter"/>
                <conv:BoolToGridLengthConverter x:Key="BoolToGridLengthConverter"/>

                <!-- Animation Resources -->
                <Storyboard x:Key="SlideInFromRight">
                        <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                                         From="300"
                                         To="0"
                                         Duration="0:0:0.3">
                                <DoubleAnimation.EasingFunction>
                                        <CubicEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                        <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                         From="0"
                                         To="1"
                                         Duration="0:0:0.3"/>
                </Storyboard>

                <Storyboard x:Key="SlideOutToRight">
                        <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                                         From="0"
                                         To="300"
                                         Duration="0:0:0.2">
                                <DoubleAnimation.EasingFunction>
                                        <CubicEase EasingMode="EaseIn"/>
                                </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                        <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                         From="1"
                                         To="0"
                                         Duration="0:0:0.2"/>
                </Storyboard>

                <!-- Typography -->
                <Style x:Key="H1"
                       TargetType="TextBlock">
                        <Setter Property="FontSize"
                                Value="24"/>
                        <Setter Property="FontWeight"
                                Value="SemiBold"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                </Style>
                <Style x:Key="H2"
                       TargetType="TextBlock">
                        <Setter Property="FontSize"
                                Value="18"/>
                        <Setter Property="FontWeight"
                                Value="SemiBold"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                </Style>
                <Style x:Key="Body"
                       TargetType="TextBlock">
                        <Setter Property="FontSize"
                                Value="13"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource SubtleTextBrush}"/>
                </Style>

                <!-- Buttons -->
                <Style x:Key="PrimaryButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="{StaticResource PrimaryBrush}"/>
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="BorderBrush"
                                Value="Transparent"/>
                        <Setter Property="Padding"
                                Value="16,8"/>
                        <Setter Property="Margin"
                                Value="0,0,8,0"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="SnapsToDevicePixels"
                                Value="True"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="{StaticResource PrimaryDarkBrush}"/>
                                                        </Trigger>
                                                        <Trigger Property="IsEnabled"
                                                                 Value="False">
                                                                <Setter Property="Opacity"
                                                                        Value="0.6"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <Style x:Key="SuccessButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="#0C8900"/>
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="BorderBrush"
                                Value="Transparent"/>
                        <Setter Property="Padding"
                                Value="16,8"/>
                        <Setter Property="Margin"
                                Value="0,0,8,0"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="SnapsToDevicePixels"
                                Value="True"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#0A7700"/>
                                                        </Trigger>
                                                        <Trigger Property="IsEnabled"
                                                                 Value="False">
                                                                <Setter Property="Opacity"
                                                                        Value="0.6"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <Style x:Key="GhostButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="Transparent"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderBrushSoft}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="16,8"/>
                        <Setter Property="Margin"
                                Value="0,0,8,0"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="MinWidth"
                                Value="140"/>
                        <Setter Property="MinHeight"
                                Value="30"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="BorderBrush"
                                                                        Value="{StaticResource PrimaryBrush}"/>
                                                                <Setter Property="Foreground"
                                                                        Value="{StaticResource PrimaryBrush}"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Sort Button - matches search box height -->
                <Style x:Key="SortButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="Transparent"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderBrushSoft}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="16,10"/>
                        <Setter Property="Margin"
                                Value="0,0,4,0"/>
                        <Setter Property="Height"
                                Value="30"/>
                        <Setter Property="MinWidth"
                                Value="100"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="4"
                                                        Height="{TemplateBinding Height}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#F0F0F0"/>
                                                                <Setter Property="BorderBrush"
                                                                        Value="{StaticResource PrimaryBrush}"/>
                                                        </Trigger>
                                                        <Trigger Property="IsPressed"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#E0E0E0"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Filter Button - changes colors based on filter state -->
                <Style x:Key="FilterButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="Transparent"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderBrushSoft}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="16,10"/>
                        <Setter Property="Margin"
                                Value="0,0,4,0"/>
                        <Setter Property="Height"
                                Value="30"/>
                        <Setter Property="MinWidth"
                                Value="80"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="4"
                                                        Height="{TemplateBinding Height}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#F0F0F0"/>
                                                        </Trigger>
                                                        <Trigger Property="IsPressed"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#E0E0E0"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                                <!-- Filter showing "Used" contacts - Red theme -->
                                <DataTrigger Binding="{Binding UsedFilter}"
                                             Value="True">
                                        <Setter Property="Background"
                                                Value="#F5E8E8"/>
                                        <Setter Property="BorderBrush"
                                                Value="#B83C3C"/>
                                        <Setter Property="Foreground"
                                                Value="#B83C3C"/>
                                </DataTrigger>

                                <!-- Filter showing "Unused" contacts - Green theme -->
                                <DataTrigger Binding="{Binding UsedFilter}"
                                             Value="False">
                                        <Setter Property="Background"
                                                Value="#E8F5E8"/>
                                        <Setter Property="BorderBrush"
                                                Value="#2D7A2D"/>
                                        <Setter Property="Foreground"
                                                Value="#2D7A2D"/>
                                </DataTrigger>
                        </Style.Triggers>
                </Style>

                <!-- TextBox -->
                <Style TargetType="TextBox">
                        <Setter Property="Padding"
                                Value="10"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderBrushSoft}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Background"
                                Value="{StaticResource CardBrush}"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                        <Setter Property="SnapsToDevicePixels"
                                Value="True"/>
                </Style>

                <!-- Edit Button - Blue background -->
                <Style x:Key="EditButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="#0496FF"/>
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="8,4"/>
                        <Setter Property="Margin"
                                Value="0,0,4,0"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="4"
                                                        Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#0381D9"/>
                                                        </Trigger>
                                                        <Trigger Property="IsPressed"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#026CB3"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Delete Button - Red background -->
                <Style x:Key="DeleteButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="#FF0000"/>
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="8,4"/>
                        <Setter Property="Margin"
                                Value="0,0,4,0"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="4"
                                                        Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#E60000"/>
                                                        </Trigger>
                                                        <Trigger Property="IsPressed"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#CC0000"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Toggle Used Button - Orange background -->
                <Style x:Key="ToggleButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="#FF8C00"/>
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="8,4"/>
                        <Setter Property="Margin"
                                Value="0,0,4,0"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="4"
                                                        Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#E67A00"/>
                                                        </Trigger>
                                                        <Trigger Property="IsPressed"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="#CC6600"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Search TextBox - optimized for smaller height -->
                <Style x:Key="SearchTextBox"
                       TargetType="TextBox">
                        <Setter Property="Padding"
                                Value="8,4"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderBrushSoft}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Background"
                                Value="{StaticResource CardBrush}"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                        <Setter Property="VerticalContentAlignment"
                                Value="Center"/>
                        <Setter Property="FontSize"
                                Value="13"/>
                        <Setter Property="SnapsToDevicePixels"
                                Value="True"/>
                </Style>

                <!-- List item style -->
                <Style x:Key="ContactListItem"
                       TargetType="ListBoxItem">
                        <Setter Property="Padding"
                                Value="10"/>
                        <Setter Property="BorderBrush"
                                Value="Transparent"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="ListBoxItem">
                                                <Border x:Name="Root"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}">
                                                        <ContentPresenter Margin="0"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <!-- Selected and Used = True -->
                                                        <MultiDataTrigger>
                                                                <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True"/>
                                                                        <Condition Binding="{Binding Used}"
                                                                                   Value="True"/>
                                                                </MultiDataTrigger.Conditions>
                                                                <Setter TargetName="Root"
                                                                        Property="Background"
                                                                        Value="#E8F5E8"/>
                                                                <Setter Property="BorderBrush"
                                                                        Value="#0C8900"/>
                                                        </MultiDataTrigger>

                                                        <!-- Selected and Used = False -->
                                                        <MultiDataTrigger>
                                                                <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True"/>
                                                                        <Condition Binding="{Binding Used}"
                                                                                   Value="False"/>
                                                                </MultiDataTrigger.Conditions>
                                                                <Setter TargetName="Root"
                                                                        Property="Background"
                                                                        Value="#F5F5F5"/>
                                                                <Setter Property="BorderBrush"
                                                                        Value="#0C8900"/>
                                                        </MultiDataTrigger>

                                                        <!-- Hover and Used = True (not selected) -->
                                                        <MultiDataTrigger>
                                                                <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True"/>
                                                                        <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}"
                                                                                   Value="False"/>
                                                                        <Condition Binding="{Binding Used}"
                                                                                   Value="True"/>
                                                                </MultiDataTrigger.Conditions>
                                                                <Setter TargetName="Root"
                                                                        Property="Background"
                                                                        Value="#E8F5E8"/>
                                                        </MultiDataTrigger>

                                                        <!-- Hover and Used = False (not selected) -->
                                                        <MultiDataTrigger>
                                                                <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True"/>
                                                                        <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}"
                                                                                   Value="False"/>
                                                                        <Condition Binding="{Binding Used}"
                                                                                   Value="False"/>
                                                                </MultiDataTrigger.Conditions>
                                                                <Setter TargetName="Root"
                                                                        Property="Background"
                                                                        Value="#F5F5F5"/>
                                                        </MultiDataTrigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Simple card -->
                <Style x:Key="Card"
                       TargetType="Border">
                        <Setter Property="Background"
                                Value="{StaticResource CardBrush}"/>
                        <Setter Property="CornerRadius"
                                Value="12"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderBrushSoft}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="16"/>
                </Style>

                <!-- Avatar circle -->
                <Style x:Key="AvatarCircle"
                       TargetType="Border">
                        <Setter Property="Width"
                                Value="40"/>
                        <Setter Property="Height"
                                Value="40"/>
                        <Setter Property="CornerRadius"
                                Value="20"/>
                        <Setter Property="Background"
                                Value="#8900f2"/>
                </Style>

                <!-- Modern Tab Styles -->
                <Style x:Key="ModernTabButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="Transparent"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource SubtleTextBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="12,8"/>
                        <Setter Property="Margin"
                                Value="0,0,2,0"/>
                        <Setter Property="Height"
                                Value="36"/>
                        <Setter Property="MinWidth"
                                Value="120"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border x:Name="Border"
                                                        Background="{TemplateBinding Background}"
                                                        CornerRadius="6"
                                                        Margin="1"
                                                        Height="{TemplateBinding Height}">
                                                        <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="*"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>

                                                                <!-- Tab Icon -->
                                                                <TextBlock x:Name="IconBlock"
                                                                           Grid.Column="0"
                                                                           FontFamily="Segoe MDL2 Assets"
                                                                           Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Tag}"
                                                                           FontSize="14"
                                                                           VerticalAlignment="Center"
                                                                           Margin="0,0,8,0"
                                                                           Foreground="{TemplateBinding Foreground}"/>

                                                                <!-- Tab Title -->
                                                                <ContentPresenter Grid.Column="1"
                                                                                  HorizontalAlignment="Center"
                                                                                  VerticalAlignment="Center"
                                                                                  RecognizesAccessKey="True"/>

                                                                <!-- Close Button -->
                                                                <Button x:Name="CloseButton"
                                                                        Grid.Column="2"
                                                                        Width="18"
                                                                        Height="18"
                                                                        Margin="8,0,0,0"
                                                                        Background="Transparent"
                                                                        BorderThickness="0"
                                                                        VerticalAlignment="Center"
                                                                        Opacity="0"
                                                                        Cursor="Hand"
                                                                        Command="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext.CloseCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext}">
                                                                        <TextBlock FontFamily="Segoe MDL2 Assets"
                                                                                   Text="&#xE8BB;"
                                                                                   FontSize="10"
                                                                                   Foreground="{StaticResource SubtleTextBrush}"
                                                                                   HorizontalAlignment="Center"
                                                                                   VerticalAlignment="Center"/>
                                                                        <Button.Style>
                                                                                <Style TargetType="Button">
                                                                                        <Setter Property="Template">
                                                                                                <Setter.Value>
                                                                                                        <ControlTemplate TargetType="Button">
                                                                                                                <Border Background="{TemplateBinding Background}"
                                                                                                                        CornerRadius="9"
                                                                                                                        Width="{TemplateBinding Width}"
                                                                                                                        Height="{TemplateBinding Height}">
                                                                                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                                                                                          VerticalAlignment="Center"/>
                                                                                                                </Border>
                                                                                                                <ControlTemplate.Triggers>
                                                                                                                        <Trigger Property="IsMouseOver"
                                                                                                                                 Value="True">
                                                                                                                                <Setter Property="Background"
                                                                                                                                        Value="{StaticResource SurfaceBrush}"/>
                                                                                                                        </Trigger>
                                                                                                                </ControlTemplate.Triggers>
                                                                                                        </ControlTemplate>
                                                                                                </Setter.Value>
                                                                                        </Setter>
                                                                                </Style>
                                                                        </Button.Style>
                                                                </Button>
                                                        </Grid>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <!-- Active Tab -->
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=DataContext.IsActive}"
                                                                     Value="True">
                                                                <Setter Property="Background"
                                                                        Value="{StaticResource CardBrush}"/>
                                                                <Setter Property="Foreground"
                                                                        Value="{StaticResource TextBrush}"/>
                                                                <Setter TargetName="Border"
                                                                        Property="Effect">
                                                                        <Setter.Value>
                                                                                <DropShadowEffect Color="Black"
                                                                                                  Direction="270"
                                                                                                  ShadowDepth="1"
                                                                                                  BlurRadius="3"
                                                                                                  Opacity="0.1"/>
                                                                        </Setter.Value>
                                                                </Setter>
                                                        </DataTrigger>

                                                        <!-- Hover Effect -->
                                                        <MultiDataTrigger>
                                                                <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}"
                                                                                   Value="True"/>
                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=DataContext.IsActive}"
                                                                                   Value="False"/>
                                                                </MultiDataTrigger.Conditions>
                                                                <Setter Property="Background"
                                                                        Value="{StaticResource SurfaceBrush}"/>
                                                                <Setter Property="Foreground"
                                                                        Value="{StaticResource TextBrush}"/>
                                                        </MultiDataTrigger>

                                                        <!-- Show close button on hover if tab is closeable -->
                                                        <MultiDataTrigger>
                                                                <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}"
                                                                                   Value="True"/>
                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=DataContext.IsCloseable}"
                                                                                   Value="True"/>
                                                                </MultiDataTrigger.Conditions>
                                                                <Setter TargetName="CloseButton"
                                                                        Property="Opacity"
                                                                        Value="1"/>
                                                        </MultiDataTrigger>

                                                        <!-- Hide icon if no icon specified -->
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=DataContext.Icon}"
                                                                     Value="">
                                                                <Setter TargetName="IconBlock"
                                                                        Property="Visibility"
                                                                        Value="Collapsed"/>
                                                                <Setter TargetName="IconBlock"
                                                                        Property="Margin"
                                                                        Value="0"/>
                                                        </DataTrigger>

                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=DataContext.Icon}"
                                                                     Value="{x:Null}">
                                                                <Setter TargetName="IconBlock"
                                                                        Property="Visibility"
                                                                        Value="Collapsed"/>
                                                                <Setter TargetName="IconBlock"
                                                                        Property="Margin"
                                                                        Value="0"/>
                                                        </DataTrigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Tab Container Style -->
                <Style x:Key="TabContainer"
                       TargetType="Border">
                        <Setter Property="Background"
                                Value="{StaticResource CardBrush}"/>
                        <Setter Property="Padding"
                                Value="8,6"/>
                        <Setter Property="BorderThickness"
                                Value="0,0,0,1"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderBrushSoft}"/>
                </Style>

                <!-- Tab Content Style -->
                <Style x:Key="TabContent"
                       TargetType="ContentPresenter">
                        <Setter Property="Margin"
                                Value="0"/>
                </Style>

                <!-- Website Navigation Dropdown Style -->
                <Style x:Key="NavDropdownButton"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="Transparent"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="16,8"/>
                        <Setter Property="Height"
                                Value="36"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="6"
                                                        Height="{TemplateBinding Height}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"
                                                                          Margin="{TemplateBinding Padding}"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="{StaticResource SurfaceBrush}"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Dropdown Menu Style -->
                <Style x:Key="DropdownMenu"
                       TargetType="StackPanel">
                        <Setter Property="Background"
                                Value="{StaticResource CardBrush}"/>
                        <Setter Property="Margin"
                                Value="0,4,0,0"/>
                </Style>

                <!-- Dropdown Menu Item Style -->
                <Style x:Key="DropdownMenuItem"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="Transparent"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource TextBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="16,12"/>
                        <Setter Property="HorizontalAlignment"
                                Value="Stretch"/>
                        <Setter Property="HorizontalContentAlignment"
                                Value="Left"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver"
                                                                 Value="True">
                                                                <Setter Property="Background"
                                                                        Value="{StaticResource SurfaceBrush}"/>
                                                        </Trigger>
                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>
        </Application.Resources>
</Application>
